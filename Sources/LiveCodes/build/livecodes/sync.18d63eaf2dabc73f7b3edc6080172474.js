var W=Object.create;var M=Object.defineProperty;var z=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,V=Object.prototype.hasOwnProperty;var Z=(e,c)=>()=>(c||e((c={exports:{}}).exports,c),c.exports);var Q=(e,c,f,m)=>{if(c&&typeof c=="object"||typeof c=="function")for(let g of H(c))!V.call(e,g)&&g!==f&&M(e,g,{get:()=>c[g],enumerable:!(m=z(c,g))||m.enumerable});return e};var G=(e,c,f)=>(f=e!=null?W(J(e)):{},Q(c||!e||!e.__esModule?M(f,"default",{value:e,enumerable:!0}):f,e));var K=Z((Ne,T)=>{var F=function(){var e=String.fromCharCode,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",m={};function g(t,n){if(!m[t]){m[t]={};for(var a=0;a<t.length;a++)m[t][t.charAt(a)]=a}return m[t][n]}var d={compressToBase64:function(t){if(t==null)return"";var n=d._compress(t,6,function(a){return c.charAt(a)});switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(t){return t==null?"":t==""?null:d._decompress(t.length,32,function(n){return g(c,t.charAt(n))})},compressToUTF16:function(t){return t==null?"":d._compress(t,15,function(n){return e(n+32)})+" "},decompressFromUTF16:function(t){return t==null?"":t==""?null:d._decompress(t.length,16384,function(n){return t.charCodeAt(n)-32})},compressToUint8Array:function(t){for(var n=d.compress(t),a=new Uint8Array(n.length*2),o=0,l=n.length;o<l;o++){var h=n.charCodeAt(o);a[o*2]=h>>>8,a[o*2+1]=h%256}return a},decompressFromUint8Array:function(t){if(t==null)return d.decompress(t);for(var n=new Array(t.length/2),a=0,o=n.length;a<o;a++)n[a]=t[a*2]*256+t[a*2+1];var l=[];return n.forEach(function(h){l.push(e(h))}),d.decompress(l.join(""))},compressToEncodedURIComponent:function(t){return t==null?"":d._compress(t,6,function(n){return f.charAt(n)})},decompressFromEncodedURIComponent:function(t){return t==null?"":t==""?null:(t=t.replace(/ /g,"+"),d._decompress(t.length,32,function(n){return g(f,t.charAt(n))}))},compress:function(t){return d._compress(t,16,function(n){return e(n)})},_compress:function(t,n,a){if(t==null)return"";var o,l,h={},w={},v="",U="",y="",x=2,S=3,p=2,u=[],r=0,s=0,b;for(b=0;b<t.length;b+=1)if(v=t.charAt(b),Object.prototype.hasOwnProperty.call(h,v)||(h[v]=S++,w[v]=!0),U=y+v,Object.prototype.hasOwnProperty.call(h,U))y=U;else{if(Object.prototype.hasOwnProperty.call(w,y)){if(y.charCodeAt(0)<256){for(o=0;o<p;o++)r=r<<1,s==n-1?(s=0,u.push(a(r)),r=0):s++;for(l=y.charCodeAt(0),o=0;o<8;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1}else{for(l=1,o=0;o<p;o++)r=r<<1|l,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=0;for(l=y.charCodeAt(0),o=0;o<16;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1}x--,x==0&&(x=Math.pow(2,p),p++),delete w[y]}else for(l=h[y],o=0;o<p;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1;x--,x==0&&(x=Math.pow(2,p),p++),h[U]=S++,y=String(v)}if(y!==""){if(Object.prototype.hasOwnProperty.call(w,y)){if(y.charCodeAt(0)<256){for(o=0;o<p;o++)r=r<<1,s==n-1?(s=0,u.push(a(r)),r=0):s++;for(l=y.charCodeAt(0),o=0;o<8;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1}else{for(l=1,o=0;o<p;o++)r=r<<1|l,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=0;for(l=y.charCodeAt(0),o=0;o<16;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1}x--,x==0&&(x=Math.pow(2,p),p++),delete w[y]}else for(l=h[y],o=0;o<p;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1;x--,x==0&&(x=Math.pow(2,p),p++)}for(l=2,o=0;o<p;o++)r=r<<1|l&1,s==n-1?(s=0,u.push(a(r)),r=0):s++,l=l>>1;for(;;)if(r=r<<1,s==n-1){u.push(a(r));break}else s++;return u.join("")},decompress:function(t){return t==null?"":t==""?null:d._decompress(t.length,32768,function(n){return t.charCodeAt(n)})},_decompress:function(t,n,a){var o=[],l,h=4,w=4,v=3,U="",y=[],x,S,p,u,r,s,b,i={val:a(0),position:n,index:1};for(x=0;x<3;x+=1)o[x]=x;for(p=0,r=Math.pow(2,2),s=1;s!=r;)u=i.val&i.position,i.position>>=1,i.position==0&&(i.position=n,i.val=a(i.index++)),p|=(u>0?1:0)*s,s<<=1;switch(l=p){case 0:for(p=0,r=Math.pow(2,8),s=1;s!=r;)u=i.val&i.position,i.position>>=1,i.position==0&&(i.position=n,i.val=a(i.index++)),p|=(u>0?1:0)*s,s<<=1;b=e(p);break;case 1:for(p=0,r=Math.pow(2,16),s=1;s!=r;)u=i.val&i.position,i.position>>=1,i.position==0&&(i.position=n,i.val=a(i.index++)),p|=(u>0?1:0)*s,s<<=1;b=e(p);break;case 2:return""}for(o[3]=b,S=b,y.push(b);;){if(i.index>t)return"";for(p=0,r=Math.pow(2,v),s=1;s!=r;)u=i.val&i.position,i.position>>=1,i.position==0&&(i.position=n,i.val=a(i.index++)),p|=(u>0?1:0)*s,s<<=1;switch(b=p){case 0:for(p=0,r=Math.pow(2,8),s=1;s!=r;)u=i.val&i.position,i.position>>=1,i.position==0&&(i.position=n,i.val=a(i.index++)),p|=(u>0?1:0)*s,s<<=1;o[w++]=e(p),b=w-1,h--;break;case 1:for(p=0,r=Math.pow(2,16),s=1;s!=r;)u=i.val&i.position,i.position>>=1,i.position==0&&(i.position=n,i.val=a(i.index++)),p|=(u>0?1:0)*s,s<<=1;o[w++]=e(p),b=w-1,h--;break;case 2:return y.join("")}if(h==0&&(h=Math.pow(2,v),v++),o[b])U=o[b];else if(b===w)U=S+S.charAt(0);else return null;y.push(U),o[w++]=S+U.charAt(0),h--,S=U,h==0&&(h=Math.pow(2,v),v++)}}};return d}();typeof define=="function"&&define.amd?define(function(){return F}):typeof T<"u"&&T!=null&&(T.exports=F)});var D=e=>JSON.parse(JSON.stringify(e));var X=()=>String(Math.random())+"-"+Date.now().toFixed();var _=async(e,c)=>new Promise(f=>{let m=X(),g=d=>{let t=d.data;t.method===c.method&&t.messageId===m&&(e.removeEventListener("message",g),f(t.data))};e.addEventListener("message",g),e.postMessage({...c,messageId:m})});var B=["jspm","skypack"],$=["unpkg","jsdelivr","fastly.jsdelivr"],I=["fastly.jsdelivr.gh","jsdelivr.gh","statically"],k={getModuleUrl:(e,{isModule:c=!0,defaultCDN:f="jspm"}={})=>{e=e.replace(/#nobundle/g,"");let m=R(e,c,f);return m||(c?"https://jspm.dev/"+e:"https://cdn.jsdelivr.net/npm/"+e)},getUrl:(e,c)=>e.startsWith("http")?e:R(e,!1,c||L())||e,cdnLists:{npm:$,module:B,gh:I},checkCDNs:async(e,c)=>{let f=[c,...k.cdnLists.npm].filter(Boolean);for(let m of f)try{if((await fetch(k.getUrl(e,m),{method:"HEAD"})).ok)return m}catch{}return k.cdnLists.npm[0]}},L=()=>{if(globalThis.appCDN)return globalThis.appCDN;try{return new URL(location.href).searchParams.get("appCDN")||k.cdnLists.npm[0]}catch{return k.cdnLists.npm[0]}},R=(e,c,f)=>{let m=c&&e.startsWith("unpkg:")?"?module":"";e.startsWith("gh:")?e=e.replace("gh",I[0]):e.includes(":")||(e=(f||(c?B[0]:$[0]))+":"+e);for(let g of Y){let[d,t]=g;if(d.test(e))return e.replace(d,t)+m}return null},Y=[[/^(jspm:)(.+)/i,"https://jspm.dev/$2"],[/^(npm:)(.+)/i,"https://jspm.dev/$2"],[/^(node:)(.+)/i,"https://jspm.dev/$2"],[/^(skypack:)(.+)/i,"https://cdn.skypack.dev/$2"],[/^(jsdelivr:)(.+)/i,"https://cdn.jsdelivr.net/npm/$2"],[/^(fastly.jsdelivr:)(.+)/i,"https://fastly.jsdelivr.net/npm/$2"],[/^(jsdelivr.gh:)(.+)/i,"https://cdn.jsdelivr.net/gh/$2"],[/^(fastly.jsdelivr.gh:)(.+)/i,"https://fastly.jsdelivr.net/gh/$2"],[/^(statically:)(.+)/i,"https://cdn.statically.io/gh/$2"],[/^(esm.run:)(.+)/i,"https://esm.run/$2"],[/^(esm.sh:)(.+)/i,"https://esm.sh/$2"],[/^(esbuild:)(.+)/i,"https://esbuild.vercel.app/$2"],[/^(bundle.run:)(.+)/i,"https://bundle.run/$2"],[/^(unpkg:)(.+)/i,"https://unpkg.com/$2"],[/^(bundlejs:)(.+)/i,"https://deno.bundlejs.com/?file&q=$2"],[/^(bundle:)(.+)/i,"https://deno.bundlejs.com/?file&q=$2"],[/^(deno:)(.+)/i,"https://deno.bundlejs.com/?file&q=https://deno.land/x/$2/mod.ts"],[/^(https:\/\/deno\.land\/.+)/i,"https://deno.bundlejs.com/?file&q=$1"],[/^(github:|https:\/\/github\.com\/)(.[^\/]+?)\/(.[^\/]+?)\/(?!releases\/)(?:(?:blob|raw)\/)?(.+?\/.+)/i,"https://deno.bundlejs.com/?file&q=https://cdn.jsdelivr.net/gh/$2/$3@$4"],[/^(gist\.github:)(.+?\/[0-9a-f]+\/raw\/(?:[0-9a-f]+\/)?.+)$/i,"https://gist.githack.com/$2"],[/^(gitlab:|https:\/\/gitlab\.com\/)([^\/]+.*\/[^\/]+)\/(?:raw|blob)\/(.+?)(?:\?.*)?$/i,"https://deno.bundlejs.com/?file&q=https://gl.githack.com/$2/raw/$3"],[/^(bitbucket:|https:\/\/bitbucket\.org\/)([^\/]+\/[^\/]+)\/(?:raw|src)\/(.+?)(?:\?.*)?$/i,"https://deno.bundlejs.com/?file&q=https://bb.githack.com/$2/raw/$3"],[/^(bitbucket:)snippets\/([^\/]+\/[^\/]+)\/revisions\/([^\/\#\?]+)(?:\?[^#]*)?(?:\#file-(.+?))$/i,"https://bb.githack.com/!api/2.0/snippets/$2/$3/files/$4"],[/^(bitbucket:)snippets\/([^\/]+\/[^\/\#\?]+)(?:\?[^#]*)?(?:\#file-(.+?))$/i,"https://bb.githack.com/!api/2.0/snippets/$2/HEAD/files/$3"],[/^(bitbucket:)\!api\/2.0\/snippets\/([^\/]+\/[^\/]+\/[^\/]+)\/files\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/!api/2.0/snippets/$2/files/$3"],[/^(api\.bitbucket:)2.0\/snippets\/([^\/]+\/[^\/]+\/[^\/]+)\/files\/(.+?)(?:\?.*)?$/i,"https://bb.githack.com/!api/2.0/snippets/$2/files/$3"],[/^(rawgit:)(.+?\/[0-9a-f]+\/raw\/(?:[0-9a-f]+\/)?.+)$/i,"https://gist.githack.com/$2"],[/^(rawgit:|https:\/\/raw\.githubusercontent\.com)(\/[^\/]+\/[^\/]+|[0-9A-Za-z-]+\/[0-9a-f]+\/raw)\/(.+)/i,"https://deno.bundlejs.com/?file&q=https://raw.githack.com/$2/$3"]];var{getUrl:ee,getModuleUrl:pe}=k;var te="0.6.64",de=ee(`malinajs@${te}/malina.js`);var A=()=>{let e=[];return{subscribe:d=>(e.push(d),{unsubscribe:()=>{e.splice(e.indexOf(d),1)}}),notify:d=>{e.forEach(t=>{t(d)})},hasSubscribers:()=>e.length>0,unsubscribeAll:()=>{e.length=0}}};var q={getValue:()=>null,setValue:()=>{},clear:()=>{},subscribe:()=>({unsubscribe:()=>{}}),unsubscribeAll:()=>{}};var C=(e,c)=>{if(c)return q;let f=A(),m=o=>f.subscribe(o),g=()=>{f.unsubscribeAll()},d=()=>{f.notify(n())},t=o=>{window.localStorage.setItem(e,JSON.stringify(o)),d()},n=()=>{let o=window.localStorage.getItem(e);if(!o)return null;try{return JSON.parse(o)}catch{return null}};return{getValue:n,setValue:t,clear:()=>{t(null),d()},subscribe:m,unsubscribeAll:g}};var P=()=>D({projects:null,templates:null,assets:null,snippets:null,recover:null,userConfig:null,userData:null,appData:null,sync:null});var N=async(e,c)=>{c||(e.recover=C("__livecodes_project_recover__",c),e.userConfig=C("__livecodes_user_config__",c),e.appData=C("__livecodes_app_data__",c))};var E=G(K());var j,nt=e=>{j=j||new Worker(e+"sync.worker.b2525246ea5145446d7a8df065b4b9cd.js?appCDN="+L());let c;j.addEventListener("message",async f=>{let m=f.data,g=m.method,d=m.args||{};if(g!=="getValue"&&g!=="setValue")return;c||(c=P(),await N(c,!1));let t,{storeKey:n,value:a}=d,o=c[n];!o||!n||(g==="getValue"&&"getValue"in o&&(t=o.getValue()),g==="setValue"&&"setValue"in o&&a!=null&&o.setValue(a),j.postMessage({...m,data:t}))})},it=async(...e)=>_(j,{method:"sync",args:e}),ct=async(...e)=>_(j,{method:"exportToLocalSync",args:e}),at=async(...e)=>_(j,{method:"exportStoreAsBase64Update",args:e}),lt=async(...e)=>_(j,{method:"restoreFromUpdate",args:e}),pt=async(...e)=>_(j,{method:"restoreFromLocalSync",args:e});export{at as exportStoreAsBase64Update,ct as exportToLocalSync,nt as init,pt as restoreFromLocalSync,lt as restoreFromUpdate,it as sync};
